{% extends "base.html" %}
{% block content %}
<h2>Dashboard</h2>
<p>Welcome, {{ current_user.name or current_user.email }}!</p>
<div class="cards">
  <div class="card">
    <h3>Total Income</h3>
    <p>GHS {{ "%.2f"|format(total_income) }}</p>
  </div>
  <div class="card">
    <h3>Total Expense</h3>
    <p>GHS {{ "%.2f"|format(total_expense) }}</p>
  </div>
  <div class="card">
    <h3>Balance</h3>
    <p>GHS {{ "%.2f"|format(balance) }}</p>
  </div>
</div>

<h3>Recent Transactions</h3>
<table>
  <thead><tr><th>Date</th><th>Type</th><th>Category</th><th>Amount (GHS)</th><th>Note</th><th>Action</th></tr></thead>
  <tbody>
    {% for t in transactions %}
    <tr>
      <td>{{ t.date }}</td>
      <td>{{ t.t_type }}</td>
      <td>{{ t.category }}</td>
      <td>{{ "%.2f"|format(t.amount) }}</td>
      <td>{{ t.note or "" }}</td>
      <td>
        <form action="{{ url_for('delete_transaction', txn_id=t.id) }}" method="post" style="display:inline;">
          <button type="submit" onclick="return confirm('Delete this transaction?')">Delete</button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="6">No transactions yet. Add one!</td></tr>
    {% endfor %}
  </tbody>
</table>

<!-- Simple data stub for Chart.js later (we'll wire it in Phase 4) -->
<script>
  const categoryTotals = {{ category_totals | tojson }};
  // later: render chart using this data
</script>
{% endblock %}
